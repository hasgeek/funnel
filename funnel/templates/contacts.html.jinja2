{% extends "layout.html.jinja2" %}
{% block title %}{% trans %}My contacts{% endtrans %}{% endblock %}

{% block bodytag %}
  {%- if not config['LEGACY'] -%}
    <body class="mui--bg-primary hg-app tabs-navbar">
  {%- else %}
    <body class="mui--bg-primary">
  {%- endif %}
{% endblock %}

{% block headline -%}
{%- endblock %}

{% block basecontentbox %}
  <div class="tabs-wrapper">
    <div class="mui-container">
      <div class="grid">
        <div class="grid__col-12">
          <div class="tabs" id="jquery-scroll-tabs">
            <a class="tabs__item tabs__item-control tabs__item-control--prev mui--text-body1 mui--text-light js-scroll-prev" aria-label="previous" href="javascript:void(0)"><i class="material-icons tabs__item-control__icon">chevron_left</i></a>
            <a href="{{ url_for('account') }}" class="tabs__item mui--text-body1 mui--text-light mui--text-uppercase">Profile</a>
            <p class="tabs__item mui--text-body1 mui--text-light mui--text-uppercase tabs__item--active">Contacts</p>
            <a href="{{ url_for('scan_contact') }}" class="tabs__item mui--text-body1 mui--text-light mui--text-uppercase">Scan badge</a>
            <a class="tabs__item tabs__item-control tabs__item-control--next mui--text-body1 mui--text-light js-scroll-next" aria-label="next" href="javascript:void(0)"><i class="material-icons tabs__item-control__icon">chevron_right</i></a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="mui-container tab-content">
    <div class="grid">
      <div class="grid__col-xs-12 grid__col-sm-6">
        {% for project,dates in contacts %}
          <div class="tab-content__results">
            <div class="collapsible__header mui--clearfix">
              <p class="mui--text-title mui--pull-left">{{ project.title }}</p>
              <div class="mui--pull-right">
                <a href="{{ url_for('contacts_project_csv', suuid=project.suuid) }}" download title="CSV" class="mui-btn mui-btn--small mui-btn--nomargin"><i class="material-icons mui--text-subhead mui--align-middle" aria-hidden="true">save_alt</i> {% trans %}CSV{% endtrans %}</a>
                <i class="material-icons mui--align-middle mui--pull-right collapsible__icon" aria-hidden="true">keyboard_arrow_down</i><i class="material-icons mui--align-middle mui--hide mui--pull-right collapsible__icon" aria-hidden="true">keyboard_arrow_up</i>
              </div>
            </div>
            <div class="collapsible__body mui-list--aligned">
              {% for daterow in dates %}
                <div class="collapsible">
                  <div class="collapsible__header mui--clearfix">
                    <p class="mui--text-title mui--pull-left">{{ daterow.date.isoformat()  }} <span class="count-chip mui--text-caption">{{ daterow.count }}</span></p>
                    <div class="mui--pull-right">
                      <a href="{{ url_for('contacts_project_date_csv', suuid=project.suuid, datestr=daterow.date) }}" download title="CSV" class="mui-btn mui-btn--small mui-btn--nomargin"><i class="material-icons mui--text-subhead mui--align-middle" aria-hidden="true">save_alt</i> {% trans %}CSV{% endtrans %}</a>
                      <i class="material-icons mui--align-middle mui--pull-right collapsible__icon" aria-hidden="true">keyboard_arrow_down</i><i class="material-icons mui--align-middle mui--hide mui--pull-right collapsible__icon" aria-hidden="true">keyboard_arrow_up</i>
                    </div>
                  </div>
                  <div class="collapsible__body mui-list--aligned">
                    {% for contact in daterow.contacts.all() %}
                      <div class="user-box">
                        <img class="user-gravatar" src="https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y" alt="{{ contact.participant.fullname }}" aria-labl="{{ contact.participant.fullname }}" />
                        <div class="mui--clearfix">
                          <div class=" mui--pull-left">
                            <p class="mui--text-body1 zero-bottom-margin">{{ contact.participant.fullname }}</p>
                            <p class="mui--text-body1">{{ contact.participant.email }}</p>
                          </div>
                          <a class="mui-btn mui-btn--flat mui-btn--primary mui--pull-right contact-card__details__download-btn" onclick="HasGeek.downloadVcard(this,'{{contact.participant.fullname}}', '{{contact.participant.email}}', '{{contact.participant.phone}}', '{{contact.participant.company}}')" download href="" aria-label="download contact"><i class="material-icons  mui--align-middle">person_add</i></a>
                        </div>
                      </div>
                    {%- endfor -%}
                  </div>
                </div>
              {%- endfor -%}
            </div>
          </div>
        {%- endfor -%}
      </div>
    </div>
  </div>
{% endblock %}

{% block footerscripts %}
  <script src="{{ url_for('static', filename=asset_path('contact')) }}" type="text/javascript"></script>
{% endblock %}
