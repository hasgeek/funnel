{% extends "layout.html.jinja2" %}
{% block title %}{% trans %}My account{% endtrans %}{% endblock %}


{% block contentwrapper %}
<div class="grid">

  <div class="grid__col-xs-12 grid__col-sm-6">
    <h2 class="mui--text-title">My profile</h2>
    <div class="card">
      <div class="card__header">
        <h3 class="mui--text-title mui--text-bold">{{ current_auth.user.fullname }}</h3>
      </div>
      <div class="card__body card__body--lgtext mui--text-subhead">
        <p><i class="material-icons mui--text-subhead mui--text-light mui--align-middle" aria-hidden="true">email</i> {{ current_auth.user.email }}</p>
        {% if current_auth.user.phone %}<p><i class="material-icons mui--text-subhead mui--text-light mui--align-middle" aria-hidden="true">call</i> {{ current_auth.user.phone }}</p>{% endif %}
      </div>
      <div class="mui-divider"></div>
      <div class="card__footer">
        <a class="mui-btn mui-btn--small mui-btn--flat mui-btn--primary" href="{{ current_auth.user.profile_url }}" title="Edit">{% trans %}Edit{% endtrans %}</a>
        <a class="mui-btn mui-btn--small mui-btn--flat mui-btn--accent" href="{{ url_for('logout') }}" title="Logout">{% trans %}Logout{% endtrans %}</a>
      </div>
    </div>
  </div>

  <div class="grid__col-xs-12 grid__col-sm-6">
    <div>
      <h2 class="mui--text-title mui--pull-left">My contacts</h2>
      <a href="{{ url_for('contacts') }}" class="mui-btn mui-btn--small mui-btn--accent mui--pull-right" title="Scan badge" data-action="Scan badge">Scan participant badge</a>
    </div>
    {% for contact in current_auth.user.scanned_contacts %}
      <div class="card mui--z2 contact-card">
        <div class="card__body mui--clearfix">
          <p class="mui--pull-left"><i class="material-icons mui--text-display3">account_circle</i></p>
          <div class="mui--pull-right contact-card__details">
            <div class="mui--clearfix">
              <h3 class="mui--text-title mui--pull-left">{{ contact.participant.fullname }}</h3>
               <a class="mui-btn mui-btn--flat mui-btn--primary mui--pull-right contact-card__details__download-btn" onclick="HasGeek.downloadVcard(this,'{{contact.participant.fullname}}', '{{contact.participant.email}}', '{{contact.participant.phone}}', '{{contact.participant.company}}')" download href="" aria-label="download contact"><i class="material-icons">save_alt</i></a>
            </div>
            <p><i class="material-icons mui--text-subhead mui--text-light mui--align-middle">email</i> {{ contact.participant.email }}</p>
            {% if contact.participant.phone %}
              <p><i class="material-icons mui--text-subhead mui--text-light mui--align-middle">call</i> {{ contact.participant.phone }}</p>
            {% endif %}
            {% if contact.participant.twitter %}
              <p><img src="{{ url_for('static', filename='img/twitter.svg') }}" title="twitter-username" class="svg-icon"/> {{ contact.participant.twitter }}</p>
            {% endif %}
            {% if contact.participant.company %}
              <p><i class="material-icons mui--text-subhead mui--text-light mui--align-middle">work</i> {{ contact.participant.company }}</p>
            {% endif %}
          </div>
          <p class="mui--text-caption mui--pull-right">Contact saved on  {{ contact.created_at.strftime("%e %B %Y")}} at {{ contact.participant.project.title}}</p>
        </div>
      </div>
    {%- else -%}
      <p><i>No contacts</i></p>
    {%- endfor -%}
  </div>
</div>
{% endblock %}

{% block footerscripts %}
  <script src="{{ url_for('static', filename=asset_path('contact')) }}" type="text/javascript"></script>
{% endblock %}
