{% from "forms.html.jinja2" import renderform_inner, rendersubmit, ajaxform %}

{%- if not request_wants.html_fragment %}
  {% extends "formlayout.html.jinja2" %}
  {% block title %}{{ title }}{% endblock title %}
{% else %}
  <link rel="stylesheet" type="text/css" href="{{ built_asset('css/form.scss') }}" />
{%- endif %}

{% block content %}
  <form id="{{ ref_id }}" method="post" accept-charset="UTF-8" class="mui-form" action="{{ request.url }}">
    {{ renderform_inner(form, formid or none) }}
    {%- if not request_wants.html_fragment %}
      {{ rendersubmit([("Save session", "save session", '')]) }}
    {%- endif %}
  </form>
  {%- if request_wants.html_fragment %}
    {{ ajaxform(ref_id=ref_id, request=request, force=false) }}
  {%- endif %}
{% endblock content %}
